<section class="flex column justify-center items-center height-100 gap-10">
    <div class="loading-screen">
        <div class="text-size-8 line-height-8 weight-bold text-slate-700">Memuat...</div>
        <progress id="loading-progress" class="width-50 height-2vh" max="9" value="0"></progress>
    </div>
</section>
<script>
    function preloadImages(urls, onProgress, onComplete) {
        let loaded = 0;
        const total = urls.length;
        
        urls.forEach(url => {
            const img = new Image();
            img.onload = img.onerror = () => {
                loaded++;
                if (onProgress) onProgress(loaded, total);
                if (loaded === total && onComplete) onComplete();
            };
            img.src = url;
        });
    }
    
    function preloadJSON(url, onProgress, onComplete) {
        fetch(url)
        .then(response => response.json())
        .then(() => {
            onProgress();
            onComplete && onComplete();
        })
        .catch(() => {
            console.warn(`Gagal load JSON: ${url}`);
            onProgress();
            onComplete && onComplete();
        });
    }
    
    const progressBar = document.getElementById('loading-progress');
    
    const images = [];
    for (let i = 1; i <= 9; i++) {
        images.push(`scene/a2-listen/img/p${i}.jpg`);
    }
    
    const totalAssets = images.length + 1; // Tambah 1 untuk JSON
    let loadedAssets = 0;
    
    const updateProgress = () => {
        loadedAssets++;
        if (progressBar) progressBar.value = loadedAssets;
        if (loadedAssets === totalAssets) {
            console.log("Semua assets sudah preload, siap lanjut!");
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen) loadingScreen.remove();
            loadSceneTrans('a1-study/p0', 'both', 'zoom-in');
        }
    };
    
    preloadImages(images, updateProgress);
    preloadJSON('assets/anim/gantar-splash.json', updateProgress);
    
</script>