<section class="flex column justify-center items-center height-100 gap-10">
    <div class="loading-screen">
        <div class="text-size-8 line-height-8 weight-bold text-slate-700">Memuat...</div>
        <progress id="loading-progress" class="width-50 height-2vh" max="9" value="0"></progress>
    </div>
</section>
<script>
    function preloadAssets(urls, onProgress, onComplete) {
        let loaded = 0;
        const total = urls.length;
        
        const update = () => {
            loaded++;
            if (onProgress) onProgress(loaded, total);
            if (loaded === total && onComplete) onComplete();
        };
        
        urls.forEach(url => {
            if (url.endsWith('.jpg') || url.endsWith('.png') || url.endsWith('.svg')) {
                const img = new Image();
                img.onload = img.onerror = update;
                img.src = url;
            } else if (url.endsWith('.json')) {
                fetch(url).then(res => res.json()).then(update).catch(update);
            } else {
                update(); // fallback
            }
        });
    }
    
    const progressBar = document.getElementById('loading-progress');
    
    const assets = [
    ...Array.from({ length: 9 }, (_, i) => `scene/a2-listen/img/p${i + 1}.jpg`),
    'scene/a2-listen/img/book.png',
    'assets/anim/gantar-splash.json' // ← JSON ditambahkan
    ];
    
    if (progressBar) progressBar.max = assets.length;
    
    preloadAssets(assets, (loaded, total) => {
        if (progressBar) progressBar.value = loaded;
    }, () => {
        console.log("Semua aset sudah preload, siap lanjut!");
        
        const loadingScreen = document.querySelector('.loading-screen');
        if (loadingScreen) loadingScreen.remove();
        
        loadSceneTrans('a2-listen/p0', 'both', 'zoom-in');
    });
</script>